

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>finite_element_basis &mdash; meep.adjoint 1.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="visualization module" href="visualization.html" />
    <link rel="prev" title="basis" href="basis.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> meep.adjoint
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">meep_adjoint Table of Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../index.html">meep_adjoint: Adjoint-solver module for pymeep</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Overview/index.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Tutorial/index.html">Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Examples/index.html">Example Gallery</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Visualization/index.html">Visualization Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Config/index.html">Configuration and customization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Implementation/MathAndPhysicsOfAdjoints.html">Implementation I: Physics and math</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Implementation/ClassHierarchy.html">Implementation II: Class hierarchy</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">API Reference</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="optimization_problem.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">optimization_problem</span></code> module</a></li>
<li class="toctree-l2"><a class="reference internal" href="timestepper.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">timestepper</span></code> module</a></li>
<li class="toctree-l2"><a class="reference internal" href="objective.html"><code class="xref py py-class docutils literal notranslate"><span class="pre">objective</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="dft_cell.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">dft_cell</span></code> module</a></li>
<li class="toctree-l2"><a class="reference internal" href="basis.html"><code class="xref py py-class docutils literal notranslate"><span class="pre">basis</span></code></a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#"><code class="xref py py-class docutils literal notranslate"><span class="pre">finite_element_basis</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="visualization.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">visualization</span></code> module</a></li>
<li class="toctree-l2"><a class="reference internal" href="option_almanac.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">option_almanac</span></code> module</a></li>
<li class="toctree-l2"><a class="reference internal" href="adjoint_options.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">adjoint_options</span></code> module</a></li>
<li class="toctree-l2"><a class="reference internal" href="visualization_options.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">visualization_options</span></code> module</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">meep.adjoint</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="index.html">:py:mod:` API Reference</a> &raquo;</li>
        
      <li><code class="xref py py-class docutils literal notranslate"><span class="pre">finite_element_basis</span></code></li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/API/finite_element_basis.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="module-meep_adjoint.finite_element_basis">
<span id="finite-element-basis"></span><h1><code class="xref py py-class docutils literal notranslate"><span class="pre">finite_element_basis</span></code><a class="headerlink" href="#module-meep_adjoint.finite_element_basis" title="Permalink to this headline">¶</a></h1>
<dl class="function">
<dt id="meep_adjoint.finite_element_basis.ExpressionFromPyFunc">
<code class="sig-prename descclassname">meep_adjoint.finite_element_basis.</code><code class="sig-name descname">ExpressionFromPyFunc</code><span class="sig-paren">(</span><em class="sig-param">g_func</em>, <em class="sig-param">offset=0.0</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/meep_adjoint/finite_element_basis.html#ExpressionFromPyFunc"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#meep_adjoint.finite_element_basis.ExpressionFromPyFunc" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct a callable dolfin.Expression from a callable python function.
Inputs: g_func: python function of a single 2D or 3D coordinate array variable p
Returns: dolfin Expression (callable function of 2D or 3D coordinate array)</p>
</dd></dl>

<dl class="function">
<dt id="meep_adjoint.finite_element_basis.ExpressionFromString">
<code class="sig-prename descclassname">meep_adjoint.finite_element_basis.</code><code class="sig-name descname">ExpressionFromString</code><span class="sig-paren">(</span><em class="sig-param">g_str</em>, <em class="sig-param">fs</em>, <em class="sig-param">offset=0.0</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/meep_adjoint/finite_element_basis.html#ExpressionFromString"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#meep_adjoint.finite_element_basis.ExpressionFromString" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct a callable dolfin.Expression from a string describing a function.
Inputs: g_str (str): mathematical expression involving x, y, z</p>
<blockquote>
<div><p>fs (df.FunctionSpace): FunctionSpace, needed only to set degree of expression</p>
</div></blockquote>
<p>Returns: dolfin Expression (callable function of 2D or 3D coordinate array)</p>
</dd></dl>

<dl class="class">
<dt id="meep_adjoint.finite_element_basis.FiniteElementBasis">
<em class="property">class </em><code class="sig-prename descclassname">meep_adjoint.finite_element_basis.</code><code class="sig-name descname">FiniteElementBasis</code><span class="sig-paren">(</span><em class="sig-param">mesh=None</em>, <em class="sig-param">mesh_file=None</em>, <em class="sig-param">region=None</em>, <em class="sig-param">size=None</em>, <em class="sig-param">center=array([0.</em>, <em class="sig-param">0.</em>, <em class="sig-param">0.])</em>, <em class="sig-param">nseg=None</em>, <em class="sig-param">element_length=None</em>, <em class="sig-param">element_type='Lagrange 1'</em>, <em class="sig-param">offset=1.0</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/meep_adjoint/finite_element_basis.html#FiniteElementBasis"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#meep_adjoint.finite_element_basis.FiniteElementBasis" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="basis.html#meep_adjoint.basis.Basis" title="meep_adjoint.basis.Basis"><code class="xref py py-class docutils literal notranslate"><span class="pre">meep_adjoint.basis.Basis</span></code></a></p>
<p>FiniteElementBasis describes a basis of 2D or 3D finite-element functions
over a rectangle, parallelepiped, or more complicated mesh, implemented
using the FENICS finite-element package.</p>
<p>Raises: ImportError if dolfin module not found</p>
<dl class="method">
<dt id="meep_adjoint.finite_element_basis.FiniteElementBasis.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">mesh=None</em>, <em class="sig-param">mesh_file=None</em>, <em class="sig-param">region=None</em>, <em class="sig-param">size=None</em>, <em class="sig-param">center=array([0.</em>, <em class="sig-param">0.</em>, <em class="sig-param">0.])</em>, <em class="sig-param">nseg=None</em>, <em class="sig-param">element_length=None</em>, <em class="sig-param">element_type='Lagrange 1'</em>, <em class="sig-param">offset=1.0</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/meep_adjoint/finite_element_basis.html#FiniteElementBasis.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#meep_adjoint.finite_element_basis.FiniteElementBasis.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Finite-element basis with given support and resolution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mesh</strong> (<em>dolfin.Mesh</em>) – </p></li>
<li><p><strong>mesh_file</strong> (<em>str</em>) – Explicit specification of finite-element mesh as a
dolfin.Mesh object or a dolfin-format mesh file.</p></li>
<li><p><strong>region</strong> (<a class="reference internal" href="dft_cell.html#meep_adjoint.dft_cell.Subregion" title="meep_adjoint.dft_cell.Subregion"><em>Subregion</em></a><em>) </em><em>__OR__ size</em><em>, </em><em>center</em><em> (</em><em>v3</em>) – </p></li>
<li><p><strong>nseg</strong> (<em>list of int</em><em>) </em><em>__OR__ element_length</em><em>(</em><em>float</em>) – <p>If mesh and mesh_file are both absent, the mesh is taken
to be a rectangular or cubic lattice over the box-shaped
domain given by region (if present) or (size,center).</p>
<p>If nseg is specified, nseg[d] is the number of segments
into which the dth linear dimension of the region is discretized.</p>
<p>Otherwise, element_length (scalar,float) specifies
a target discretization lengthscale. If element_length is None,
it is taken from options[‘element_length’]</p>
</p></li>
<li><p><strong>element_type</strong> (<em>str</em>) – <p>The type of finite-element basis function defined on the mesh,
expressed as a compound string of the form ‘family degree’
for functions of finite-element family <em>family</em> and
nonnegative-integer degree <em>degree</em>. For example,
‘Lagrange 1’ and ‘Lagrange 2’ correspond to the usual
linear and quadratic functions supported on triangles/tetrahedra.</p>
<p>For more information on finite-element types, consult e.g.</p>
<ol class="arabic simple">
<li><p>The FENICS documentation:
<a class="reference external" href="https://fenicsproject.org/docs/dolfin/1.5.0/python/programmers-reference/mesh/index.html">https://fenicsproject.org/docs/dolfin/1.5.0/python/programmers-reference/mesh/index.html</a></p></li>
<li><p>The “Periodic Table of Finite Elements:”
<a class="reference external" href="http://femtable.org/">http://femtable.org/</a></p></li>
</ol>
</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="meep_adjoint.finite_element_basis.FiniteElementBasis.parameterized_function">
<code class="sig-name descname">parameterized_function</code><span class="sig-paren">(</span><em class="sig-param">beta_vector</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/meep_adjoint/finite_element_basis.html#FiniteElementBasis.parameterized_function"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#meep_adjoint.finite_element_basis.FiniteElementBasis.parameterized_function" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct and return a callable, updatable element of the function space.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>beta_vector</strong> (<em>np.array of dimension self.dim and datatype float</em>) – expansion coefficients</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>After the statement</dt><dd><p>func = basis.parameterized_function(beta_vector)</p>
</dd>
</dl>
<p>we have:
1. func is a callable scalar function of one spatial variable:</p>
<blockquote>
<div><p>func(p) = f_0 + sum_n beta_n * b_n(p)</p>
</div></blockquote>
<ol class="arabic simple" start="2">
<li><dl class="simple">
<dt>func has a set_coefficients method that updates an internal cache, i.e.</dt><dd><p>func.set_coefficients(new_beta_vector)</p>
</dd>
</dl>
</li>
</ol>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>a class <cite>func</cite> with the following properties</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="meep_adjoint.finite_element_basis.FiniteElementBasis.project">
<code class="sig-name descname">project</code><span class="sig-paren">(</span><em class="sig-param">g</em>, <em class="sig-param">grid=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/meep_adjoint/finite_element_basis.html#FiniteElementBasis.project"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#meep_adjoint.finite_element_basis.FiniteElementBasis.project" title="Permalink to this definition">¶</a></dt>
<dd><p>Given an arbitrary function g(x), invoke the performance-optimized routines
in FENICS to compute the projection g^p(x) == sum_n g^p_n b_n(x).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>grid</strong> (<em>g</em><em>,</em>) – function specification as in make_dolfin_callable</p>
</dd>
</dl>
<dl class="simple">
<dt>Return value:</dt><dd><p>Projection coefficients as numpy array of dimension self.dim</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="meep_adjoint.finite_element_basis.FunctionFromSamples">
<code class="sig-prename descclassname">meep_adjoint.finite_element_basis.</code><code class="sig-name descname">FunctionFromSamples</code><span class="sig-paren">(</span><em class="sig-param">g_samples</em>, <em class="sig-param">grid</em>, <em class="sig-param">offset=0.0</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/meep_adjoint/finite_element_basis.html#FunctionFromSamples"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#meep_adjoint.finite_element_basis.FunctionFromSamples" title="Permalink to this definition">¶</a></dt>
<dd><p>Given an array of function samples at the points of a grid, construct
a callable dolfin function by interpolation.
Inputs:  g_samples (np.array): 2D or 3D array of function samples</p>
<blockquote>
<div><p>grid (Grid):          grid of Points at which function was sampled</p>
</div></blockquote>
<p>Returns: Callable dolfin function of 2D or 3D coordinate array p</p>
</dd></dl>

<dl class="function">
<dt id="meep_adjoint.finite_element_basis.make_dolfin_callable">
<code class="sig-prename descclassname">meep_adjoint.finite_element_basis.</code><code class="sig-name descname">make_dolfin_callable</code><span class="sig-paren">(</span><em class="sig-param">g</em>, <em class="sig-param">grid=None</em>, <em class="sig-param">fs=None</em>, <em class="sig-param">offset=0.0</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/meep_adjoint/finite_element_basis.html#make_dolfin_callable"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#meep_adjoint.finite_element_basis.make_dolfin_callable" title="Permalink to this definition">¶</a></dt>
<dd><p>given a basis of expansion functions (or a ‘function space’ in FENICS
parlance), a common task is to compute the projection onto the basis
of some arbitrary given input function g(x), which may be specified
in various different ways. FENICS implements optimized routines for
this procedure, the use of which requires that the input function be
packaged in the form of dolfin entities like ‘Expression’ or ‘Function’
or ‘Constant’. This is a switchboard routine that hands off to
one of the helper routines/classes below to effect this packaging
for various types of python function specification.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>g</strong> – target function specification, which may be any of the following:
(a) callable python function of a 2D or 3D array variable
(b) string describing a mathematical expression of x,y,z
(c) constant
(d) numpy array of function samples on the regular grid ‘grid’</p></li>
<li><p><strong>grid</strong> – Grid on which target function was sampled for case (d) above</p></li>
<li><p><strong>fs</strong> – Function space, needed only for case (b) above, and then
only to ensure sufficiently a high-degree representation</p></li>
<li><p><strong>offset</strong> – constant offset added to value of caller’s g function</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Return value:</dt><dd><p>dolfin/FENICS callable function that may be passed as e.g.
the ‘v’ parameter to dolfin.fem.projection.project()</p>
</dd>
</dl>
</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="visualization.html" class="btn btn-neutral float-right" title="visualization module" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="basis.html" class="btn btn-neutral float-left" title="basis" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, MEEP project

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>